<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="utf8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
        <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
        <link rel="stylesheet" href="../_css/geral.css">
    </head>
    <body>
        <div class="topo" class="material-symbols-outlined">
            <img class="logo" src="../_img/logomarca.png" alt="logomarca">

            <ul class="menu">
                <li><a href="../_site/home.html">HOME</a></li>
                <li><a href="../_site/html5.html">HMTL5</a></li>
                <li><a href="../_site/css.html">CSS</a></li>
                <li><a href="../_site/js.html">JAVASCRIPT</a></li>
                <li><a href="../_site/contato.html">CONTATOS</a></li>
                <li><a href="../_site/perfil.html" style="color: red;">MINHA CONTA</a></li>
                <li><a href="../index.html" onclick="sessionStorage.removeItem('user');">LOGOFF
                    <span id="ico" class="material-symbols-outlined">
                        lock_person
                        </span>
                    </a>
                </li>
            </ul> 
        </div>
        <div class="all">
            <form class="form-horizontal" id="cadFormulario" onload="carregarConta()">
                <fieldset>
                  <legend>Atualizar da Conta</legend>
                    <div class="form-group" id="divWths">
                        <label class="col-md-4 control-label" for="txtCelular">Celular</label>
                        <div class="col-md-4" style="width: 110px; text-align: center;">
                        <input type="text" placeholder="(00)" maxlength="2" class="form_input" id="ddd" name="ddd" required="required" 
                        oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" onblur="this.value='('+ this.value +')'" onfocus="this.value=''"/>
                        </div>
                        <div class="col-md-4">
                        <input id="telefone" maxlength="9" name="telefone" type="text" placeholder="Exemplo 00000-0000 ou 0000-0000" class="form_input" required="required"
                        onblur="mascaraDeTelefone(this)" onfocus="this.value='', tirarHifen(this)" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" > 
                        </div>
                    </div>
                                
                    <div class="form-group">
                      <label class="col-md-4 control-label" for="txtEmail">E-mail</label>  
                      <div class="col-md-6">
                      <input id="email" name="email" type="text" placeholder="seuemail@email.com.br" class="form_input" required="required" onblur="IsEmail(this.value)">
                      </div>
                    </div>
                           
                    <div class="form-group">
                      <label class="col-md-4 control-label" for="txtPwd">Senha</label>
                      <div class="col-md-4">
                        <input id="senha" name="senha" type="password" placeholder="Digite sua senha" class="form_input" required="required">
                      </div>
                    </div>
                    
                    <div class="form-group">
                      <label class="col-md-4 control-label" for="bntSend"></label>
                      <div class="col-md-8">
                        <button type="submit" id="bntSend" name="bntSend" class="submit" onclick="updateConta()">Atualizar Conta</button>
                        <button type="button" id="bntExcluir" name="bntExcluir" class="bntExcluir" onclick="excluirConta()">Excluir Conta</button>
                      </div>
                    </div>
                </fieldset>
                </form>  
                <script>
                  function updateConta() {
                      const ddd = document.getElementById('ddd').value;
                      const telefone = document.getElementById('telefone').value;
                      const email = document.getElementById('email').value;
                      const senha = document.getElementById('senha').value;

                      const data = { email: email, senha: senha };
                      
                      fetch('http://localhost:8080/updateConta', {
                          method: 'POST',
                          headers: {
                              'Content-Type': 'application/json'
                          },
                          body: JSON.stringify(data)
                      })
                      function buscarDados() {
    fetch(`http://localhost:8080/updateConta ${email}`, {
        method: 'post',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(jsonData)
    })
                      .then(response => {

                          console.log(response)
                          if (response.ok) {
                              var user = {email: email,};
                              sessionStorage.setItem('user', JSON.stringify(user));
                              window.location.href = "../_site/home.html";
                          } else if (response.status === 401) {
                              alert("Email ou senha incorretos");
                          } else {
                              throw new Error('Erro interno do servidor');
                          }
                      })
                      .catch(error => {
                          console.error('Erro:', error);
                          alert("Erro interno do servidor " + error);
                      });
                  }
              </script>
        </div>
        <footer class="footer">
            <p class="pj2024">Projeto final Curso de programação JavaScript Senac 2024</p>
            <p class="textp">Professor: Lucas Souto</p>
            <p class="textp">Alunos: Alessandro R. Nascimento | Aninhah Alves | Rhaicon R. Lourenço | Victor Julio | Marcio M. Araujo</p>
            <img id="img1" src="../_img/senac100colorida.png" alt="senac100colorida"><img id="img2" src="../_img/javascript.png" alt="javascript">
        </footer>
    </body>
</html>